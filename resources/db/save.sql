-- :name insert-look-up :! :n
-- :doc Insert cve info
INSERT INTO CVE_LOOK_UP(id,
                        description,
                        reference_urls,
                        impact_score,
                        severity,
                        published_date,
                        last_modified_date,
                        meta_file)
VALUES (:id,
        :description,
        :reference_urls,
        :impact_score,
        :severity,
        (:publishedDate) :: TIMESTAMP,
        (:lastModifiedDate) :: TIMESTAMP,
        :meta_file)
ON CONFLICT (id) DO NOTHING;

-- :name insert-look-up-one :! :n
-- :doc Insert cve info
INSERT INTO CVE_LOOK_UP(id,
                        description,
                        reference_urls,
                        impact_score,
                        severity,
                        published_date,
                        last_modified_date,
                        meta_file)
VALUES :t*:datas
ON CONFLICT (id)
DO NOTHING;


-- :name check-file-already-processed :<!
-- :insert
-- :doc select cve info
INSERT INTO cve_look_up_files(name)
VALUES (:name)
on CONFLICT do NOTHING
RETURNING name;
