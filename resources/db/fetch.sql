-- :name insert-look-up :! :n
-- :doc Insert cve info
INSERT INTO CVE_LOOK_UP(id,
                        description,
                        reference_urls,
                        impact_score,
                        severity,
                        published_date,
                        last_modified_date,
                        meta_file)
VALUES (:id,
        :description,
        :reference_urls,
        :impact_score,
        :severity,
        (:publishedDate) :: TIMESTAMP,
        (:lastModifiedDate) :: TIMESTAMP,
        :meta_file)
ON CONFLICT (id) DO NOTHING;

-- :name select-cve-id :! :n
-- :doc select cve info
SELECT *
FROM cve_look_up
WHERE cve_id = :searched;


